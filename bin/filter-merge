#!/bin/sh

echo "### $GITHUB_EVENT_PATH"

set -e

if [ -z "$GITHUB_EVENT_PATH" ]; then
  echo "\$GITHUB_EVENT_PATH" not found
  exit 1
fi

# Pretty Print
echo $GITHUB_ACTION
echo $GITHUB_EVENT_NAME
echo $GITHUB_EVENT_PATH
echo $GITHUB_WORKSPACE
echo $GITHUB_REF
echo jq . < "$GITHUB_EVENT_PATH" # run through jq to pretty print


expected="true"
actual=$(jq -r .base.merged "$GITHUB_EVENT_PATH")

echo "$actual" | grep -Eq "^$expected$" || {
  echo "merged is \"$actual\", not \"$expected\""
  exit 78
}